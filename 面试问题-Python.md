# Python常见面试问题

[TOC]

## Python锁

Python中的各种锁：
一、全局解释器锁（GIL）

1、什么是全局解释器锁

每个CPU在同一时间只能执行一个线程，那么其他的线程就必须等待该线程的全局解释器，使用权消失后才能使用全局解释器，即使多个线程直接不会相互影响在同一个进程下也只有一个线程使用cpu，这样的机制称为全局解释器锁（GIL）。GIL的设计简化了CPython的实现，使的对象模型包括关键的内建类型，如：字典等，都是隐含的，可以并发访问的，锁住全局解释器使得比较容易的实现对多线程的支持，但也损失了多处理器主机的并行计算能力。

2、全局解释器锁的好处

1）、避免了大量的加锁解锁的好处

2）、使数据更加安全，解决多线程间的数据完整性和状态同步

3、全局解释器的缺点

多核处理器退化成单核处理器，只能并发不能并行。

4、GIL的作用：

多线程情况下必须存在资源的竞争，GIL是为了保证在解释器级别的线程唯一使用共享资源（cpu）。

二、同步锁

1、什么是同步锁？

同一时刻的一个进程下的一个线程只能使用一个cpu，要确保这个线程下的程序在一段时间内被cpu执，那么就要用到同步锁。

2、为什么用同步锁？

因为有可能当一个线程在使用cpu时，该线程下的程序可能会遇到io操作，那么cpu就会切到别的线程上去，这样就有可能会影响到该程　　序结果的完整性。

3、怎么使用同步锁？

只需要在对公共数据的操作前后加上上锁和释放锁的操作即可。

4、同步锁的所用：

为了保证解释器级别下的自己编写的程序唯一使用共享资源产生了同步锁。

三、死锁

1、什么是死锁？

指两个或两个以上的线程或进程在执行程序的过程中，因争夺资源或者程序推进顺序不当而相互等待的一个现象。

2、死锁产生的必要条件？

互斥条件、请求和保持条件、不剥夺条件、环路等待条件

3、处理死锁的基本方法？

预防死锁、避免死锁（银行家算法）、检测死锁（资源分配）、解除死锁：剥夺资源、撤销进程

四、什么是递归锁？

在Python中为了支持同一个线程中多次请求同一资源，Python提供了可重入锁。这个RLock内部维护着一个Lock和一个counter变量，counter记录了acquire的次数，从而使得资源可以被多次require。直到一个线程所有的acquire都被release，其他的线程才能获得资源。递归锁分为可递归锁与非递归锁。

五、什么是乐观锁？

假设不会发生并发冲突，只在提交操作时检查是否违反数据完整性。

六、什么是悲观锁？

假定会发生并发冲突，屏蔽一切可能违反数据完整性的操作。

七、python常用的加锁方式？

互斥锁、可重入锁、迭代死锁、互相调用死锁、自旋锁。

## 如何将小端存储模式转化为大端存储模式

针对Python32位整形的情况

```python
val = ((val << 8) & 0xFF00FF00) | ((val >> 8) & 0x00FF00FF)
return (val << 16) | (val >> 16)
```

## Note

1. Ctrl+C会挂掉程序
2. 通过is可以判断两个变量引用的是否是同一个对象，==判断对象的值是否相等，可以通过id查看引用对象的地址
3. list.pop(0)删除list第一个元素
4. join()函数进行字符串拼接



## count(*),count(1)和count(列名)的区别

count(\*),count(1)在统计的时候不会忽略Null,count(列名)在统计的时候会忽略Null。若列名为主键,count(列名)会比count(1),count(\*)快,反之则count(1),count(\*)更快。表中有多个列且没有主键,则count(1)执行效率优于count(\*)。若表中只有一个字段则count(*)最快。

## Python Dict按照Value进行排序

```python
sorted(d.items(), key = lambda x:x[1], reverse= True)
sorted(d.items(), key = lambda x:x[1], reverse= False)
```

## Python中dict和list的区别，dict的内部实现

dict：

1. 查找速度快，占用内存较大，dict不能用来存储有序集合，dict用{}表示，
2. list查找速度慢，占用内存较小，list用[]表示

dict实现：

通过hash表实现的，dict有一个数组，数组的索引是通过hash处理后得到的，hash函数的目的是使得键值对均匀分布在数组中

## Python方法解析顺序

Python方法解析顺序优先级从高到低为：实例本身->类->继承类（继承关系越近，越先定义，优先级越高）

## Python多进程

方式一: os.fork()
方式二:使用multiprocessing模块:创建Process的实例，传入任务执行函数作为参数

方式三:使用multiprocessing模块:派生Process的子类，重写run方法

方式四:使用进程池Pool

## 什么是Python生成器

python生成器是一个返回可以迭代对象的函数,可以被用作控制循环的迭代行为。生成器类似于返回值为数组的一个函数,这个函数可以接受参数,可以被调用,一般的函数会返回包括所有数值的数组,生成器一次只能返回一个值,这样消耗的内存将会大大减小。